# ================================
# CONFIGURACIÓN GENERAL DEL PROYECTO
# ================================

# Símbolo principal a descargar desde MetaTrader 5.
simbolo: "EURUSD"

# (Opcional) Símbolo exógeno (p.ej., US500/SPX/SPY) si lo habilitas en bt.exog.enable
simbolo_spy: "US500"

# Timeframe para la descarga desde MT5 (válidos: M1/M5/M15/M30/H1/H4/D1/W1/MN1)
timeframe: "D1"

# Cuántas barras traer desde MT5 antes de cualquier recorte/resampleo.
cantidad_datos: 1500

# Conexión a MetaTrader 5
mt5:
  login: 68238343
  password: "Colombia123*"
  server: "RoboForex-Pro"
  path: "C:\\Program Files\\RoboForex - MetaTrader 5\\terminal64.exe"

# ================================
# EDA (Exploratory Data Analysis)
# ================================
eda:
  # Frecuencia de resampleo para estandarizar OHLC antes de los análisis.
  # H = intradía por horas (H1/H4); D = diario.
  frecuencia_resampleo: "D"

# ================================
# MODO NORMAL (compatibilidad)
# ================================
# Se usará solo si NO existe 'modelos:' con activos.
modelo:
  nombre: "ARIMA"           # "ARIMA" | "SARIMA" | "PROPHET" | "LSTM"
  objetivo: "retornos"      # "retornos" | "nivel"
  horizonte: 5
  params:
    order: [1, 1, 1]
    seasonal_order: [0, 0, 0, 0]
    enforce_stationarity: false
    enforce_invertibility: false

# ================================
# CATÁLOGO DE MODELOS (multi-modelo)
# ================================
# El pipeline ejecuta TODOS los modelos con enabled: true, en el modo seleccionado (normal o backtest).
modelos:
  - name: "ARIMA"
    enabled: true
    objetivo: "retornos"
    horizonte: 5
    params:
      auto: true          # selección por ventana
      metric: aic         # o "bic"
      seasonal: false     # true si hay estacionalidad; define m
      m: 12               # solo si seasonal=true
      modo: retornos      # o "nivel"
      max_p: 2
      max_q: 2
      max_P: 2
      max_Q: 2
      max_d: 2
      max_D: 1
      enforce_stationarity: false
      enforce_invertibility: false
    normal: {}
    backtest:
      engine: "model" 
# --------------------------------
  # 2. RANDOM WALK (Nuevo)
  # --------------------------------
  - name: "RW"  # Puede llamarlo "RandomWalk" o "RW"
    enabled: true
    objetivo: "retornos" # O 'level'
    horizonte: 5
    params:
      # Fija el orden a (0, 1, 0)
      order: [0, 1, 0] 
      # Sin estacionalidad
      seasonal_order: [0, 0, 0, 0] 
      enforce_stationarity: false
      enforce_invertibility: false
    normal: {}
    backtest:
      # También debe usar el motor 'classic_auto'
      engine: "classic_auto"

  - name: "PROPHET"
    enabled: true
    objetivo: "retornos"
    horizonte: 5
    params:
      frequency_hint: "D1"          # CLAVE para intradía H1/H4
      changepoint_prior_scale: 0.05
      seasonality_mode: "additive"
    normal: {}
    backtest:
      engine: "model"
      prophet:
        frequency_hint: "D1"
        yearly_seasonality: false
        weekly_seasonality: true
        daily_seasonality: true
        interval_width: 0.9

  - name: "LSTM"
    enabled: true
    objetivo: "retornos"
    horizonte: 5
    params:
      window: 64
      units: 64
      dropout: 0.2
      epochs: 40
      batch_size: 32
      lr: 0.001
      loss: "mse"
      optimizer: "adam"
      scaler: "standard"
      patience: 5
      model_dir: "outputs/modelos/lstm"
    normal: {}
    backtest:
      engine: "model"
      lstm:
        horizon: 5

# ================================
# BACKTEST (walk-forward)
# ================================
bt:
  initial_train: 800
  step: 50
  horizon: 1
  target: "returns"         # 'returns' | 'level'
  pip_size: 0.0001

  # Umbrales de decisión
  threshold_mode: "fixed"   # 'fixed' | 'atr' | 'garch'
  threshold_pips: 12.0
  atr_window: 14
  atr_k: 0.60
  garch_k: 0.60
  min_threshold_pips: 10.0
  log_threshold_used: false

  # Auto-modelo (ARIMA/SARIMA)
  auto:
    scan: {}
    rescan_each_refit: false
    rescan_every_refits: 999999

  # Exógenas (opcional)
  exog:
    enable: false
    lags: [1, 2, 3]

  # Salidas
  outxlsx: "outputs/evaluacion.xlsx"
  outdir_plots: "outputs/backtest_plots"

# ================================
# DEFAULTS POR MODO (opcional)
# ================================
defaults:
  normal: {}
  backtest: {}
